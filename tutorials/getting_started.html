<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.28">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Getting Started – powfacpy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-b719d3d4935f2b08311a76135e2bf442.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b9197cbe6dce745ee4f4b73487b41930.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">powfacpy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../docs/index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/tutorials/overview.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/docs/overview.html"> 
<span class="menu-text">Docs</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/FraunhIEE-UniKassel-PowSysStability/powfacpy" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#accessing-objects" id="toc-accessing-objects" class="nav-link active" data-scroll-target="#accessing-objects"><span class="header-section-number">1</span> Accessing Objects</a></li>
  <li><a href="#accessing-project-folders-and-data" id="toc-accessing-project-folders-and-data" class="nav-link" data-scroll-target="#accessing-project-folders-and-data"><span class="header-section-number">2</span> Accessing Project Folders and Data</a></li>
  <li><a href="#getting-objects-from-the-active-study-case" id="toc-getting-objects-from-the-active-study-case" class="nav-link" data-scroll-target="#getting-objects-from-the-active-study-case"><span class="header-section-number">3</span> Getting Objects from the Active Study Case</a></li>
  <li><a href="#type-hints" id="toc-type-hints" class="nav-link" data-scroll-target="#type-hints"><span class="header-section-number">4</span> Type Hints</a></li>
  <li><a href="#setting-and-getting-object-attributes" id="toc-setting-and-getting-object-attributes" class="nav-link" data-scroll-target="#setting-and-getting-object-attributes"><span class="header-section-number">5</span> Setting and Getting Object Attributes</a></li>
  <li><a href="#creating-objects-and-directories" id="toc-creating-objects-and-directories" class="nav-link" data-scroll-target="#creating-objects-and-directories"><span class="header-section-number">6</span> Creating Objects and Directories</a></li>
  <li><a href="#copying-objects" id="toc-copying-objects" class="nav-link" data-scroll-target="#copying-objects"><span class="header-section-number">7</span> Copying Objects</a></li>
  <li><a href="#deleting-objects" id="toc-deleting-objects" class="nav-link" data-scroll-target="#deleting-objects"><span class="header-section-number">8</span> Deleting Objects</a></li>
  <li><a href="#further-useful-methods" id="toc-further-useful-methods" class="nav-link" data-scroll-target="#further-useful-methods"><span class="header-section-number">9</span> Further Useful Methods</a></li>
  <li><a href="#the-folder-class" id="toc-the-folder-class" class="nav-link" data-scroll-target="#the-folder-class"><span class="header-section-number">10</span> The Folder Class</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/FraunhIEE-UniKassel-PowSysStability/powfacpy/blob/main/tutorials/getting_started.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/FraunhIEE-UniKassel-PowSysStability/powfacpy/blob/main/tutorials/getting_started.ipynb" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/FraunhIEE-UniKassel-PowSysStability/powfacpy/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Getting Started</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>The tutorials have been moved to the <a href="https://fraunhiee-unikassel-powsysstability.github.io/powfacpy/docs/tutorials/overview.html">website</a>. The version here is no longer maintained.</strong></p>
<p>This tutorial gives an overview of the interaction with the <em>PowerFactory</em> database using <em>powfacpy</em>. The methods introduced in this tutorial serve as a basis to do more complex things and to write more readable code using less lines of code. Furthermore, the error messages <em>powfacpy</em> provides are a great help when debugging larger scripts or in larger projects that use the python API of <em>PowerFactory</em>.</p>
<p>For a complete list of classes and methods, please have a look at the <em>API</em> Chapter of the documentation or at the source code.</p>
<p>Similar to using the Python API of <em>PowerFactory</em> directly, we first need to import the powerfactory module from <em>PowerFactory</em>’s installation directory (in case you want to access PowerFactory externally using IPython/Jupyter) and get the application.</p>
<div id="cell-3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you use IPython/Jupyter:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sys.path.append(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"C:</span><span class="er">\</span><span class="vs">Program Files</span><span class="dv">\D</span><span class="vs">IgSILENT</span><span class="er">\</span><span class="vs">PowerFactory 2023 SP5</span><span class="er">\</span><span class="vs">Python</span><span class="ch">\3</span><span class="dv">.</span><span class="vs">11"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># you may use a different directory</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the PF app</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> powerfactory</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> powerfactory.GetApplication()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then import <em>powfacpy</em> and create an instance of class <code>PFActiveProject</code> (with argument <code>app</code>). This interface class is mainly used to interact with the active project in the <em>PowerFactory</em> database as we will see below.</p>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> powfacpy.base.active_project <span class="im">import</span> ActiveProject</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pfp <span class="op">=</span> ActiveProject(app)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code>pfp</code> has an attribute <code>app</code> that can be used similar to the <code>app</code> variable we loaded from the <code>powerfactory</code> module.</p>
<p>The <em>PowerFactory</em> project used in this tutorial can be found in the powfacpy repository under *tests_input_tests.pfd*.</p>
<p>Here are two ways to 1. show the PowerFactory application and 2. activate a project:</p>
<div id="cell-7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>app.Show()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>app.ActivateProject(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"powfacpy</span><span class="er">\</span><span class="vs">powfacpy_tests_copy_where_tests_run"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># You may change the project path.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pfp.app.Show()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>pfp.app.ActivateProject(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"powfacpy</span><span class="er">\</span><span class="vs">powfacpy_tests_copy_where_tests_run"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># You may change the project path.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0</code></pre>
</div>
</div>
<p>So where does <code>pfp</code> differ from the Python interface that <code>app</code> provides? Let’s see.</p>
<section id="accessing-objects" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Accessing Objects</h1>
<p>Let’s access an object from the <em>PowerFactory</em> database. When using <code>app</code>, we would use the methods <code>app.GetProjectFolder</code>, <code>app.GetChildren</code> or <code>app.GetContents</code>. Instead, we use <code>pfp.get_obj</code> with the path of the object (<strong>relative to the folder of the active project</strong>) as an argument:</p>
<div id="cell-11" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mv_terminal <span class="op">=</span> pfp.get_obj(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Terminal MV"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>[0]</code> at the end is necessary because the method always returns a list (with one element in this case).</p>
<p>Note that you can easily copy and paste the path from the data manager while selecting the object in the data tree:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/object_path.png" class="img-fluid figure-img"></p>
<figcaption>object path</figcaption>
</figure>
</div>
<p><code>pfp.get_obj</code> also differs in other ways from <code>app.GetContents</code> and <code>app.GetCalcRelevantObjects</code>. You can set a condition for the objects that you want to access, which is best described by an example:</p>
<div id="cell-14" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hv_terminals <span class="op">=</span> pfp.get_obj(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="ch">\*</span><span class="dv">.</span><span class="vs">ElmTerm"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    condition<span class="op">=</span><span class="kw">lambda</span> x: x.uknom <span class="op">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First of all, we use a wildcard (<code>*.ElmTerm</code>) to access all terminals in the <code>Grid</code> folder. The <code>condition</code> argument is a function that defines a certain condition the objects have to fulfill and returns a boolean value. In this case, the input argument <code>x</code> is an <code>ElmTerm</code> and <code>x.uknom &gt; 50</code> gets its attribute <code>uknom</code> (nominal voltage) and checks whether it is larger than 50 (kV). Using this <code>.uknom</code> notation is equivalent to using <code>getattr(x, "uknom")</code>, which is a python method that returns an attribute of any object (also <em>PowerFactory</em> objects). You can also define more complex functions, such as <code>lambda x: x.uknom &gt; 50 and x.uknom &lt; 200</code> to access terminals between 50 and 200 kV.</p>
<p>It is also possible to include subfolders in the search for objects:</p>
<div id="cell-16" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>terminals <span class="op">=</span> pfp.get_obj(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\*</span><span class="dv">.</span><span class="vs">ElmTerm"</span>, include_subfolders<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will search in <code>Network Model\Network Data</code> and all its subfolders (by default <code>include_subfolders</code> is <code>False</code>, be carefull as including all subfolders in the search can affect the performance).</p>
<p>What’s also very helpful is that <code>pfp.get_obj</code> throws an error if the path is incorrect and shows exactly where it fails. So</p>
<p><code>terminals = pfp.get_obj(r"Network Model\wrong_folder_name\*.ElmTerm")</code></p>
<p>will throw an error:</p>
<p>PFPathError: ‘wrong_folder_name’ does not exist in ’_baseModel’</p>
<p>By default, an exception is also raised if no objects are found in the specified folder. For example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>terminals <span class="op">=</span> pfp.get_obj(<span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="dv">\w</span><span class="vs">rong_object_name</span><span class="op">*</span><span class="vs">"</span>, include_subfolders<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>returns</p>
<p>PFPathError: ’wrong_object_name*’ does not exist in ’_baseModelData’</p>
<p>This can be turned off by setting the optional argument <code>error_if_non_existent=False</code>, then an empty list will be returned.</p>
<p>If you want to access objects in a folder many times and don’t want to use the whole path relative to the active project every time, you can also specifiy a parent folder where the search path starts (this can also be more performant):</p>
<div id="cell-19" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>grid_folder <span class="op">=</span> pfp.get_obj(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>)[<span class="dv">0</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mv_terminal <span class="op">=</span> pfp.get_obj(<span class="st">"Terminal MV"</span>, parent_folder<span class="op">=</span>grid_folder)[<span class="dv">0</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>hv_terminal <span class="op">=</span> pfp.get_obj(<span class="st">"Terminal HV 1"</span>, parent_folder<span class="op">=</span>grid_folder)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also use brackets to call <code>get_obj</code> (the <code>PFActiveProject</code> class defines a <code>__getitem__</code> method that calls <code>get_obj</code> without optional arguments):</p>
<div id="cell-21" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>terminals <span class="op">=</span> pfp[</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="ch">\*</span><span class="dv">.</span><span class="vs">ElmTerm"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>get_obj</code> command can become verbose with many keyword arguments. This can be inconvenient, for example when you have to call the method many times with the same arguments. <code>powfacpy</code> provides the <code>get_object_partial</code> method which returns a <code>Callable</code>. This way you can define new variations of <code>get_obj</code>:</p>
<div id="cell-23" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>get_obj_subf <span class="op">=</span> pfp.get_obj_partial(include_subfolders<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This can now be used with further arguments of 'get_obj' as follows (and will always assume 'include_subfolders=True'):</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>terminals <span class="op">=</span> get_obj_subf(<span class="st">"*.ElmTerm"</span>, parent_folder<span class="op">=</span>grid_folder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Under the hood the <code>partial</code> function from the built-in <code>functools</code> module of Python is used (it is actually pretty simple to do the above with any Python method/function). Note that for the commonly required inclusion of subfolders in the search there is actually a separate method <code>get_obj_including_subfolders</code> available (another alternative for network objects in <code>get_calc_relevant_obj</code> as described below).</p>
<p>An alternative to <code>pfp.get_obj</code> is <code>pfp.get_unique_obj</code>. Use this function if you want to access a single unique object (i.e.&nbsp;an object that you expect to only exist once) from the database and want to avoid the <code>[0]</code> (which is easily forgotten).</p>
<div id="cell-25" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>terminal_1 <span class="op">=</span> pfp.get_unique_obj(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Terminal HV 1"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>get_unique_obj</code> will throw an error if the specified path is not attributable to a single unique object (i.e.&nbsp;also when two or more objects are found).</p>
<p>Finally, yet another alternative for getting network objects is <code>get_calc_relevant_obj</code>: <em>powfacpy</em> wraps the <code>GetCalcRelevenatObjects</code> method and adds optional arguments, similar to <code>get_obj</code>:</p>
<div id="cell-27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>terminals <span class="op">=</span> pfp.get_calc_relevant_obj(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ElmTerm"</span>, error_if_non_existent<span class="op">=</span><span class="va">False</span>, includeOutOfService<span class="op">=</span><span class="dv">0</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="accessing-project-folders-and-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Accessing Project Folders and Data</h1>
<p>The <code>PFActiveProject</code> class defines a number of properties to directly access relevant project folders (under the hood, the <code>GetProjectFolder</code> and <code>GetDataFolder</code> methods are used). Here are some examples (you may just type <code>pfp.folder</code> and your IDE will autocomplete all the properties):</p>
<div id="cell-29" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pfp.study_cases_folder  <span class="co"># This is a getter property returning StudyCases.IntPrjfolder</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pfp.network_model_folder</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pfp.zones_folder</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>pfp.variations_folder</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>pfp.operation_scenarios_folder</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;powerfactory.DataObject &lt;l1&gt;\seberlein.IntUser\powfacpy\powfacpy_tests_copy_where_tests_run.IntPrj\Network Model.IntPrjfolder\Operation Scenarios.IntPrjfolder&lt;/l1&gt;&gt;</code></pre>
</div>
</div>
<p>To get all active grids/networks (ElmNet) use:</p>
<div id="cell-31" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>active_networks <span class="op">=</span> pfp.get_active_networks()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pfp.app.GetCalcRelevantObjects(".ElmNet") also returns the summary grid in the study case which is usually not desired.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="getting-objects-from-the-active-study-case" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Getting Objects from the Active Study Case</h1>
<p>The native <code>GetFromStudyCase</code> method returns the first object found that satisfies the criteria or creates a new object in the active study case. This is a common source of errors when more than one object satisfies the criteria and this goes unnoticed (this often happens for example when users work on the same project with different language settings). You can use the <em>powfacpy</em> method instead which prints a warning or raises an error if the the object found is not unique:</p>
<div id="cell-33" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>results_obj <span class="op">=</span> pfp.get_from_study_case(<span class="st">"ElmRes"</span>, if_not_unique<span class="op">=</span><span class="st">"warning"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>d:\User\seberlein\FraunhIEE-UniKassel-PowSysStability\powfacpy\docs\tutorials\..\..\src\powfacpy\base\active_project.py:173: UserWarning: The returned *.ElmRes object is not unique in the  study case: 'Study Cases\test_active_project_interface\Study Case 1'. Make sure that the correct *.ElmRes object is used.
  warn(</code></pre>
</div>
</div>
</section>
<section id="type-hints" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Type Hints</h1>
<p>Type hints are used in Python to improve the readability and code completion, but do not actually affect the excuted code (except when you do static type checking). They are often seen in function/method definitions and are preceded by a <em>colon</em>, e.g.:</p>
<div id="cell-35" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add(a: <span class="bu">int</span>, b: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This means that the function expects two input arguments of type integer and returns an integer. <em>powfacpy</em> defines protocol classes for (almost) all <em>PowerFactory</em> classes (more than 200) from the scripting reference (with very few exceptions) and a few additional classes (such as ‘IntSite’ which is not mentioned in the scripting reference).</p>
<p>In the following example a type hint is used (‘:ElmTerm’). Your IDE will then autocomplete all attributes (methods and data) of the variable ‘terminal’:</p>
<div id="cell-37" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> powfacpy.pf_class_protocols <span class="im">import</span> ElmTerm</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>terminal: ElmTerm <span class="op">=</span> pfp.get_unique_obj(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Terminal HV 1"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>terminal.uknom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>110.0</code></pre>
</div>
</div>
<p>Any modern IDE should autocomplete your code while writing:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/type_hints.png" class="img-fluid figure-img"></p>
<figcaption>type_hints</figcaption>
</figure>
</div>
<p>Note that this also works with lists:</p>
<div id="cell-39" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>terminals: <span class="bu">list</span>[ElmTerm] <span class="op">=</span> pfp.get_calc_relevant_obj(<span class="st">"ElmTerm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-and-getting-object-attributes" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Setting and Getting Object Attributes</h1>
<p>How about setting data in the database? You can set attributes of an object as follows:</p>
<div id="cell-41" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pfp.set_attr(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Terminal MV"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"uknom"</span>: <span class="dv">33</span>, <span class="st">"outserv"</span>: <span class="dv">0</span>},</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So with only one command we set the attributes “uknom” and “outserv” of the terminal. This saves time and is also very readable code. Note that the method <code>set_attr</code> accepts the path (string) but also a <em>PowerFactory</em> object. For example, we could also use the object <code>mv_terminal</code> that we loaded above:</p>
<div id="cell-43" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pfp.set_attr(mv_terminal, {<span class="st">"uknom"</span>: <span class="dv">33</span>, <span class="st">"outserv"</span>: <span class="dv">0</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This applies to many other methods in <code>powfacpy</code>. Loading the object only once and then using the object can be more efficient than using the path string many times.</p>
<p>If you want to get an attribute of an object, write:</p>
<div id="cell-45" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nominal_voltage <span class="op">=</span> pfp.get_attr(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Terminal MV"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"uknom"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>nominal_voltage <span class="op">=</span> pfp.get_attr(mv_terminal, <span class="st">"uknom"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>nominal_voltage <span class="op">=</span> pfp.get_attr(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Terminal MV"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"uknom"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    parent_folder<span class="op">=</span><span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_active_project_interface</span><span class="dv">\G</span><span class="vs">rid"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-objects-and-directories" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Creating Objects and Directories</h1>
<p>If you want to create a new object, use:</p>
<div id="cell-47" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> powfacpy.pf_class_protocols <span class="im">import</span> BlkDef, IntPrjfolder</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>new_obj: BlkDef <span class="op">=</span> pfp.create_by_path(<span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="dv">\d</span><span class="vs">ummy</span><span class="dv">.</span><span class="vs">BlkDef"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will create an object of class “BlkDef” with the name “dummy” in the folder “LibraryModels”. You can also use</p>
<div id="cell-49" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>new_obj: BlkDef <span class="op">=</span> pfp.create_in_folder(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dummy.BlkDef"</span>, <span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models"</span>, overwrite<span class="op">=</span><span class="va">True</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Or equivalent:</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>models_folder: IntPrjfolder <span class="op">=</span> pfp.get_unique_obj(<span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models"</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>new_obj: BlkDef <span class="op">=</span> pfp.create_in_folder(<span class="st">"dummy.BlkDef"</span>, models_folder, overwrite<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which will overwrite the former object (this avoids that <em>PowerFactory</em> creates <em>dummy(1), dummy(2), …</em> every time the code is run). <code>overwrite=True</code> is the default setting.</p>
<p>To create a directory, i.e.&nbsp;a nested folder structure, use</p>
<div id="cell-51" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pfp.create_directory(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"New Study Case</span><span class="er">\</span><span class="vs">Cases Normal Opration"</span>, parent_folder<span class="op">=</span><span class="st">"Study Cases"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>&lt;powerfactory.DataObject &lt;l1&gt;\seberlein.IntUser\powfacpy\powfacpy_tests_copy_where_tests_run.IntPrj\Study Cases.IntPrjfolder\New Study Case\Cases Normal Opration&lt;/l1&gt;&gt;</code></pre>
</div>
</div>
</section>
<section id="copying-objects" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Copying Objects</h1>
<p>The method <code>copy_obj</code> can be seen as a method that uses <code>get_obj</code> as a first step to access objects and then copies them to a target folder under the hood. Therefore, <code>copy_obj</code> shares many (optional) input arguments with <code>get_obj</code> to first get the objects to be copied. Additionally, a target folder is required. For example, to copy all objects from a source folder to a target folder, write</p>
<div id="cell-53" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>source_folder <span class="op">=</span> <span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestDummyFolder"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>target_folder <span class="op">=</span> <span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestCopyMultiple"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>new_copied_objects <span class="op">=</span> pfp.copy_obj(<span class="st">"*"</span>, target_folder, parent_folder<span class="op">=</span>source_folder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code>parent folder</code> is an optional argument (used for the <strong>source</strong>), so you could also specify the full object path as the first argument instead of using <code>*</code> (similar to <code>get_obj</code>). To select certain objects from the source folder, you can use optional arguments like <code>condition</code> or <code>include_subfolders</code>, also similar to the <code>get_obj</code> method. The method also accepts a list of <em>PowerFactory</em> objects:</p>
<div id="cell-55" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>list_of_objects_to_copy <span class="op">=</span> pfp.get_obj(<span class="st">"*"</span>, parent_folder<span class="op">=</span>source_folder)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>target_folder_obj <span class="op">=</span> pfp.get_unique_obj(<span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestCopyMultiple"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>new_copied_objects <span class="op">=</span> pfp.copy_obj(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    list_of_objects_to_copy, target_folder_obj, overwrite<span class="op">=</span><span class="va">True</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the target folder object (instead of a path string) is used (second argument).</p>
<p>If you want to copy a single object, use <code>copy_single_obj</code>. You have the option to give it a new name (<code>loc_name</code> attribute):</p>
<div id="cell-58" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>new_copy <span class="op">=</span> pfp.copy_single_obj(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">Linear_interpolation"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestCopy"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    new_name<span class="op">=</span><span class="st">"new_dummy_name"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First input here is the path of the object to be copied, but you can also use a <em>PowerFactory</em> object.</p>
</section>
<section id="deleting-objects" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Deleting Objects</h1>
<p>Deleting objects works in a similar fashion, because under the hood it uses <code>get_obj</code> and deletes the returned objects in the second step.</p>
<div id="cell-61" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pfp.delete_obj(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"to_be_deleted*"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    parent_folder<span class="op">=</span><span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestDelete"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    include_subfolders<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    error_if_non_existent<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And of course you could also use <em>PowerFactory</em> objects as an input:</p>
<div id="cell-63" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>objects_in_folder <span class="op">=</span> pfp.get_obj(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"to_be_deleted*"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    parent_folder<span class="op">=</span><span class="vs">r"Library</span><span class="dv">\D</span><span class="vs">ynamic Models</span><span class="er">\</span><span class="vs">TestDelete"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    error_if_non_existent<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>pfp.delete_obj(objects_in_folder, error_if_non_existent<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also delete all objects in a folder:</p>
<div id="cell-65" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pfp.clear_folder(<span class="st">"Library</span><span class="er">\</span><span class="st">Dynamic Models</span><span class="er">\</span><span class="st">TestDelete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="further-useful-methods" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Further Useful Methods</h1>
<p>Further helpful methods are briefly described in the following. <code>get_upstream_obj</code> returns an upsream object that meets a condition (i.e.&nbsp;the method goes upwards in the folder hierarchy until a parent object is found that meets the condition).</p>
<p>Here this is used to find the grid that contains a given object:</p>
<div id="cell-67" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> pfp.get_unique_obj(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data</span><span class="ch">\t</span><span class="vs">est_database_interface</span><span class="dv">\G</span><span class="vs">rid</span><span class="er">\</span><span class="vs">Voltage source ctrl</span><span class="er">\</span><span class="vs">Frequency"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> pfp.get_upstream_obj(obj, <span class="kw">lambda</span> x: x.loc_name <span class="op">==</span> <span class="st">"Grid"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pfp.get_path_of_object(grid))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Network Model\Network Data\test_database_interface\Grid</code></pre>
</div>
</div>
<p><code>get_path_of_object</code> returns the path of an object relative to the active project and without any class names. The user can can directly copy the returned string to the data manager to quickly find the object in the <em>PowerFactory</em> app.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/object_path.png" class="img-fluid figure-img"></p>
<figcaption>object path</figcaption>
</figure>
</div>
<p>There are more methods to get the path of an object:</p>
<div id="cell-69" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pfp.get_path_of_object(grid))  <span class="co"># path inside project</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pfp.get_path_of_obj_with_class_names(grid))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pfp.get_full_path_of_object(grid))  <span class="co"># full path in database</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pfp.get_full_path_of_object_with_class_names(grid))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Network Model\Network Data\test_database_interface\Grid
Network Model.IntPrjfolder\Network Data.IntPrjfolder\test_database_interface\Grid.ElmNet
\seberlein\powfacpy\powfacpy_tests_copy_where_tests_run\Network Model\Network Data\test_database_interface\Grid
\seberlein.IntUser\powfacpy\powfacpy_tests_copy_where_tests_run.IntPrj\Network Model.IntPrjfolder\Network Data.IntPrjfolder\test_database_interface\Grid.ElmNet</code></pre>
</div>
</div>
</section>
<section id="the-folder-class" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> The Folder Class</h1>
<p>Most of the functionality described above is not limited to the folder of the active project, but can be used with any folder in the database. The class ‘Folder’ can be used with any folder. Path input arguments are then relative to that folder (and not to the active project as above, unless of course a ‘parent_folder’ is specified):</p>
<div id="cell-71" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> powfacpy.base.folder <span class="im">import</span> Folder</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>network_data_folder <span class="op">=</span> Folder(<span class="vs">r"Network Model</span><span class="er">\</span><span class="vs">Network Data"</span>, app)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> network_data_folder.get_unique_obj(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"test_active_project_interface</span><span class="er">\</span><span class="st">Grid"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># relative to 'Network Data' folder</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(network_data_folder.get_path_of_object(grid))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test_active_project_interface\Grid</code></pre>
</div>
</div>
<p>Note that ‘Folder’ instances are iterable. For example, you can use a for-loop to iterate through the (direct) children of the folder:</p>
<div id="cell-73" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">object</span> <span class="kw">in</span> network_data_folder:</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(network_data_folder.get_path_of_object(<span class="bu">object</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Areas
Backbones
Virtual Power Plants
Boundaries
Cable Layouts
Circuits
Distribution correlations
Feeders
Meteo Stations
Operators
Owners
Paths
Routes
Zones
test_plot_interface
network_for_elmfiles
test_case_studies
test_dyn_sim_interface
test_active_project_interface
test_network_interface
test_results_interface
test_database_interface
test_model_exchange_interfaces</code></pre>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/FraunhIEE-UniKassel-PowSysStability\.github\.io\/powfacpy\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/FraunhIEE-UniKassel-PowSysStability/powfacpy/blob/main/tutorials/getting_started.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/FraunhIEE-UniKassel-PowSysStability/powfacpy/blob/main/tutorials/getting_started.ipynb" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/FraunhIEE-UniKassel-PowSysStability/powfacpy/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>